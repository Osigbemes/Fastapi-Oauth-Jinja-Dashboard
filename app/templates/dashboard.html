<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">
  <div class="container py-4">

    <!-- Welcome Banner -->
    <div class="p-4 mb-4 bg-primary text-white rounded shadow-sm">
      <h2 class="mb-0">Good afternoon, {{ user.name }} ðŸ‘‹</h2>
      <p class="mb-0">Welcome back! Hereâ€™s an overview of your account.</p>
    </div>

    <div class="row mb-4">
      {% for metric in metrics %}
      <div class="col-md-3">
        <div class="card shadow-sm mb-3">
          <div class="card-body text-center">
            <h6 class="card-title text-muted">{{ metric.key | capitalize }}</h6>
            <h3 class="fw-bold">{{ metric.value }}</h3>
          </div>
        </div>
      </div>
      {% endfor %}

      <!-- Google Drive -->
      <div class="col-md-3">
        <div class="card shadow-sm mb-3">
          <div class="card-body text-center">
            <h6 class="card-title text-muted">Drive Files</h6>
            <h3 class="fw-bold">{{ drive_data.file_count or 0 }}</h3>
            <p class="text-muted small">Last: {{ drive_data.last_file }}</p>
            <p class="text-muted small">
              Storage: {{ drive_data.storage_used }}MB /
              {{ drive_data.storage_limit }}MB
            </p>
          </div>
        </div>
      </div>

      <!-- Google Calendar -->
      <div class="col-md-3">
        <div class="card shadow-sm mb-3">
          <div class="card-body text-center">
            <h6 class="card-title text-muted">Calendar</h6>
            <h3 class="fw-bold">{{ calendar_data.event_count or 0 }}</h3>
            <p class="text-muted small">Next: {{ calendar_data.next_event }}</p>
            <p class="text-muted small">Next Event Time: {{ calendar_data.next_event_time }}</p>
          </div>
        </div>
      </div>

      <!-- Gmail -->
      <div class="col-md-3">
        <div class="card shadow-sm mb-3">
          <div class="card-body text-center">
            <h6 class="card-title text-muted">Unread Emails</h6>
            <h3 class="fw-bold">{{ gmail_data.unread_count or 0 }}</h3>
            <p class="text-muted small">Important: {{ gmail_data.important_unread or 0 }}</p>
            <p class="text-muted small">Recent: {{ gmail_data.recent_subject }}</p>
          </div>
        </div>
      </div>
    </div>



    <!-- Chart + Activity -->
    <div class="row mb-4">
      <!-- Chart -->
      <div class="col-md-8">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Activity Trend</h5>
            <canvas id="activityChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Activity Feed -->
      <div class="col-md-4">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Recent Activity</h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">Signed in with {{ user.provider | capitalize }}</li>
              <li class="list-group-item">Profile created: {{ user.email }}</li>
              <li class="list-group-item">Metrics seeded for demo</li>
              <li class="list-group-item">Last login: Today</li>
              <li class="list-group-item">Account status: Active âœ…</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="text-center text-muted mt-5">
      <small>Built with FastAPI + Authlib + Bootstrap Â· Demo App</small>
    </footer>
  </div>

  <script>
    // Example chart with dummy data
    const ctx = document.getElementById('activityChart');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
          label: 'Logins',
          data: [3, 5, 2, 8, 4, 6, 7], // Replace with dynamic if needed
          borderColor: '#0d6efd',
          backgroundColor: 'rgba(13, 110, 253, 0.2)',
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: { y: { beginAtZero: true } }
      }
    });
  </script>
</body>
</html>
